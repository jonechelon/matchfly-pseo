# MatchFly Deploy – GitHub Pages via `/docs` folder

**Last updated:** February 2026

The MatchFly site is published using **GitHub Pages** with the **`/docs`** folder from the **`main`** branch as the site root. There is no use of Netlify or the `gh-pages` branch.

---

## 1. Deploy Model

- **Site source:** branch `main`, folder `docs/`
- **How content reaches `docs/`:**
  - Local: you run `python src/generator.py`, which writes to `docs/`
  - CI: the `.github/workflows/update-flights.yml` workflow runs the generator and commits + pushes changes to `docs/` on `main`

GitHub serves everything in `docs/` at `https://<user>.github.io/<repo>/` or, with custom domain, at `https://matchfly.org`.

---

## 2. GitHub Configuration

1. Repository → **Settings** → **Pages**.
2. Under **Build and deployment**:
   - **Source:** Deploy from a branch
   - **Branch:** `main`
   - **Folder:** `/docs`
3. Save. The site will now be served from the `docs/` folder.

---

## 3. Custom Domain (matchfly.org)

For the site to respond at `https://matchfly.org`:

1. **CNAME in repository**  
   The generator writes `matchfly.org` to `docs/CNAME` (one line, without `https://` and without trailing slash). This file must be in `docs/` and versioned.

2. **DNS at domain provider**  
   Configure a **CNAME** record (or A/AAAA per GitHub documentation) pointing the domain to the GitHub Pages address (e.g., `<user>.github.io`). Details: [GitHub – Configuring a custom domain](https://docs.github.com/en/pages/configuring-a-custom-domain-for-your-github-pages-site).

3. **HTTPS**  
   GitHub Pages provides HTTPS for custom domains; it may take a few minutes for the certificate to be provisioned.

---

## 4. `.nojekyll` File

GitHub Pages, by default, processes the site with Jekyll. Jekyll ignores folders and files starting with `_`.

- The generator creates an **empty** `docs/.nojekyll` file.
- This disables Jekyll and the `docs/` folder is served as-is (including any content with `_` in the name in the future).

---

## 5. CI Workflow (update-flights.yml)

Summary flow:

| Step | Action |
|------|--------|
| 1 | Repository checkout |
| 2 | Setup Python 3.12 (pip cache) |
| 3 | `pip install -r requirements.txt` |
| 4 | `python voos_proximos_finalbuild.py` (syncs data → `data/flights-db.json`) |
| 5 | `python src/generator.py` (generates entire site in `docs/`) |
| 6 | `git add docs/` → commit (if there are changes) → `git push` |

The job uses `permissions: contents: write` to be able to push to `main`. The commit only occurs if there are changes in `docs/` (`git diff --staged --quiet || git commit ...`).

---

## 6. Running Locally

1. **Generate site in `docs/`:**
   ```bash
   python src/generator.py
   ```
2. **Prerequisite:** `data/flights-db.json` must exist (generated by `voos_proximos_finalbuild.py` or historical import).
3. **View:** open `docs/index.html` in browser or serve the `docs/` folder with a local server (e.g., `python -m http.server --directory docs 8000`).

Netlify, Vercel, or `gh-pages` branch are not needed for the current deploy.

---

## 7. Post-Deploy Checklist

- [ ] Settings → Pages: Source = branch `main`, folder `/docs`
- [ ] File `docs/CNAME` exists and contains only `matchfly.org`
- [ ] File `docs/.nojekyll` exists (empty)
- [ ] After workflow runs, `docs/` contains `index.html`, `sitemap.xml`, `robots.txt`, `404.html` and subfolders `voo/` and `destino/`
- [ ] Custom domain configured in DNS and HTTPS active (if using matchfly.org)
