# Phase 1: MatchFly Documentation Analysis and Triage

**Date:** February 2026  
**Objective:** Triage, consolidation, and update plan for documentation in `_internal_docs/` to reflect the current project state (GitHub Pages via `/docs`, Split-Flap UI, Python Generator V2).

---

## 1. Current code state (reference)

### 1.1 Real infrastructure

| Aspect | Current state (code) |
|--------|---------------------|
| **Site output** | `docs/` (not `public/`) |
| **Generator** | `src/generator.py` → writes to `docs/`, `docs/voo/`, `docs/destino/` |
| **Deploy** | GitHub Pages via folder **Source: main → /docs**; workflow commits to `docs/` and pushes to `main` |
| **CNAME** | Generated in `docs/CNAME` with `matchfly.org` |
| **404** | `docs/404.html` generated by generator |
| **Data script** | `voos_proximos_finalbuild.py` (root); **not** `run_gru_scraper.py` (is in `_archive/`) |
| **Pipeline** | `run_pipeline.sh` exists; workflow: checkout → Python 3.12 → pip install → `voos_proximos_finalbuild.py` → `python src/generator.py` → git add docs/ → commit → push |
| **Netlify / gh-pages** | Not used; deploy is commit to `main` in `docs/` |

### 1.2 Relevant folder structure

```
matchfly-pseo/
├── .github/workflows/update-flights.yml   # Single workflow: commit docs/ to main
├── data/                                  # flights-db.json, .xls ANAC
├── docs/                                  # Generator output (static site)
├── src/
│   ├── generator.py                       # Output dir = docs
│   ├── enrichment.py, historical_importer.py, indexer.py, scl_corrections.py
│   ├── scrapers/ (gru_flights_scraper, gru-scraper, gru_proximos/)
│   └── templates/ (base, index, tier2-anac400, 404, atrasados, cancelados, cidades, privacy, components/, includes/)
├── _internal_docs/                        # Internal documentation (not public)
├── _archive/                              # Old scripts (run_gru_scraper, run_historical_import, etc.)
├── voos_proximos_finalbuild.py            # Scraper/data sync (used by CI)
├── run_pipeline.sh
└── README.md
```

---

## 2. Obsolete files (move to `_internal_docs/archive/`)

Files describing old architecture, scripts that no longer exist in root, or replaced flows.

| File | Reason |
|------|--------|
| **CURSOR_PERPLEXITY_FIX.md** | Point fix for IDE/Perplexity configuration; not project architecture. |
| **teste_escrita.txt** | Test file ("Python can write here!"); no technical value. |
| **SUCCESS_BANNER.txt** | Milestone completion banner; references to `public/`, `run_historical_import.py`, `open public/index.html`. |
| **FINAL_OVERVIEW.txt** | Old structure: `public/` as output, `run_gru_scraper.py`, Netlify, gh-pages. |
| **GITHUB_ACTIONS_GUIDE.md** | Complete guide based on **Netlify** (NETLIFY_AUTH_TOKEN, NETLIFY_SITE_ID); current flow is commit to `docs/` on main, without Netlify. |
| **CLOUD_COST_OPTIMIZATION.md** | Describes Netlify → gh-pages migration with `peaceiris/actions-gh-pages`; today deploy is via `/docs` folder on main, not gh-pages. |

**Action:** Create `_internal_docs/archive/` and **move** (don't delete) the 6 files above.

---

## 3. Redundancies and proposed merges

### 3.1 Duplicate summaries and guides

- Several `*_SUMMARY.md`, `*_GUIDE.md`, `*_OVERVIEW.txt` cover the same topics with different detail levels.
- Proposal: reduce **quantity** of files and create **few master** updated ones.

### 3.2 Merge → ARCHITECTURE.md (architecture and flow)

**Merge into a single updated `_internal_docs/ARCHITECTURE.md`:**

| Source | Content to use |
|--------|----------------|
| **GENERATOR_V2_ARCHITECTURE.md** | Generator steps, validations, filters; **update** all mentions of `public/` → `docs/`. |
| **PANORAMA_TECNICO_COMPLETO.md** | Overview, data flow, stack, components; **update** deploy section and structure (docs/ as output, without Netlify). |
| **PROJECT_STRUCTURE.txt** | Folder tree; **replace** with current tree (docs/, _internal_docs/, voos_proximos_finalbuild.py). |
| **PROJECT_STRUCTURE_UPDATED.txt** | Same; consolidate into single tree in ARCHITECTURE.md. |

**Target content:**  
Flow **Data (JSON/CSV) → Python Generator (Jinja2) → docs/ → GitHub Pages (Source: main, /docs)**. Current folder structure, components in `src/`, role of `CNAME` and `.nojekyll` in `docs/`.

**After merge:** The 4 files above can be moved to `_internal_docs/archive/` (keep as historical reference).

### 3.3 Merge → DEPLOY.md (deploy and CI)

**Merge into a single `_internal_docs/DEPLOY.md`:**

| Source | Content to use |
|--------|----------------|
| **DEPLOYMENT_SUMMARY.md** | Deploy concepts, local commands; **rewrite** for output in `docs/`, without Netlify. |
| **GITHUB_ACTIONS_SUMMARY.md** | Workflow description; **update** to real workflow (no JSON cache, no Netlify): checkout → pip → voos_proximos_finalbuild → generator → git add docs/ → commit → push. |

**Target content:**  
Deploy via **GitHub Pages with `/docs` folder**: configuration in Settings → Pages (main, /docs), role of `CNAME` in `docs/`, step-by-step of current workflow and how to run locally (`python src/generator.py`, view `docs/`).

**After merge:** The 2 files can go to `_internal_docs/archive/`.

### 3.4 Files that remain (with point updates)

| File | Action |
|------|--------|
| **GENERATOR_GUIDE.md** | Keep; **update** all references `public/` → `docs/`, open commands (`open docs/index.html`). |
| **GRU_SCRAPER_USAGE.md** | Keep if describing `src/scrapers/` and data sources; **verify** if mentions `run_gru_scraper.py` and update to `voos_proximos_finalbuild.py` or run_pipeline where it makes sense. |
| **QUICKSTART.md** | Keep; **update** to: virtual environment → `pip install -r requirements.txt` → `python voos_proximos_finalbuild.py` (or run_pipeline) → `python src/generator.py` → `open docs/index.html`. |
| **QUICK_REFERENCE.md** | Keep; **update** commands and paths to `docs/` and current scripts; remove/adjust references to `run_historical_import.py` if in _archive. |
| **GOOGLE_INDEXING_SETUP.md** | Keep; **update** sitemap path: `public/sitemap.xml` → `docs/sitemap.xml`. |
| **INDEXER_IMPLEMENTATION_SUMMARY.md** | Keep; **update** paths: `public/` → `docs/`. |
| **HISTORICAL_IMPORT_README.md** | Keep; **update** to: script in `_archive/run_historical_import.py` or use of `src/historical_importer.py`; generator output in `docs/`. |
| **HISTORICAL_IMPORT_SUMMARY.md** | Keep; **update** paths and commands to `docs/`. |
| **HISTORICAL_IMPORTER_GUIDE.md** | Keep; **update** `open public/` → `docs/`. |
| **IATA_DICTIONARY_GUIDE.md** | Keep; **update** examples with `public/` → `docs/` if present. |
| **IATA_EXPANSION_SUMMARY.md** | Keep; **update** references to `public/` → `docs/`. |
| **IMPLEMENTATION_COMPLETE.md** | Keep as historical record; optional: note at top "Historical document; see ARCHITECTURE.md and DEPLOY.md for current state." |
| **PERPLEXITY_INTEGRATION_SUMMARY.md** | Keep if Perplexity service is still used in project. |
| **VISUAL_GUIDE.md** | Keep; **update** all paths and examples to `docs/` and current UI (Split-Flap when applicable). |
| **CLOUD_COST_OPTIMIZATION.md** | **Archive** (already listed in obsolete); talks about old Netlify and gh-pages. |

---

## 4. Consolidated action plan (for approval)

### 4.1 Archive (move to `_internal_docs/archive/`)

1. Create directory `_internal_docs/archive/`.
2. Move to `archive/`:
   - CURSOR_PERPLEXITY_FIX.md  
   - teste_escrita.txt  
   - SUCCESS_BANNER.txt  
   - FINAL_OVERVIEW.txt  
   - GITHUB_ACTIONS_GUIDE.md  
   - CLOUD_COST_OPTIMIZATION.md  

### 4.2 Create master files (new/rewritten)

3. **README.md (root)**  
   - What MatchFly is (GRU flight aggregation, SEO static pages, affiliate).  
   - Description of current UI (Split-Flap / Flip Cards).  
   - How to run locally: `python voos_proximos_finalbuild.py` (data) and `python src/generator.py` (site).  
   - Summary structure: `src/`, `docs/` (site output), `data/`, `_internal_docs/`.  
   - Link to internal documentation in `_internal_docs/` (ARCHITECTURE, DEPLOY, QUICKSTART).

4. **_internal_docs/ARCHITECTURE.md**  
   - Merge of GENERATOR_V2_ARCHITECTURE, PANORAMA_TECNICO_COMPLETO, PROJECT_STRUCTURE, PROJECT_STRUCTURE_UPDATED.  
   - Flow: Data → Generator (Jinja2) → docs/ → GitHub Pages.  
   - Current folder structure; no reference to `public/` or Netlify.

5. **_internal_docs/DEPLOY.md**  
   - Merge of DEPLOYMENT_SUMMARY and GITHUB_ACTIONS_SUMMARY.  
   - Deploy via `/docs` (main), CNAME, current workflow (commit + push to `docs/`).

### 4.3 Archive after merge

6. After creating ARCHITECTURE.md and DEPLOY.md, move to `_internal_docs/archive/`:  
   - GENERATOR_V2_ARCHITECTURE.md  
   - PANORAMA_TECNICO_COMPLETO.md  
   - PROJECT_STRUCTURE.txt  
   - PROJECT_STRUCTURE_UPDATED.txt  
   - DEPLOYMENT_SUMMARY.md  
   - GITHUB_ACTIONS_SUMMARY.md  

### 4.4 Point updates (without merge)

7. In **kept** files (GENERATOR_GUIDE, GRU_SCRAPER_USAGE, QUICKSTART, QUICK_REFERENCE, GOOGLE_INDEXING_SETUP, INDEXER_IMPLEMENTATION_SUMMARY, HISTORICAL_IMPORT_*, IATA_*, VISUAL_GUIDE):  
   - Replace `public/` with `docs/` where it's site output path.  
   - Adjust commands to current scripts (`voos_proximos_finalbuild.py`, `python src/generator.py`, `open docs/index.html`).  
   - Optional: remove emojis from changed sections, per design rule.

### 4.5 Phase 2 (after approval)

8. Use Perplexity (or MCP) to:  
   - Validate `sitemap.xml` and `robots.txt` practices (generator.py) vs Google Search Console for static sites.  
   - Verify if "commit to main in `/docs`" pattern and workflow permissions are aligned with current GitHub Actions recommendations.

---

## 5. Visual summary

```
_internal_docs/
├── archive/                          # NEW: obsolete + pre-merge
│   ├── CURSOR_PERPLEXITY_FIX.md
│   ├── teste_escrita.txt
│   ├── SUCCESS_BANNER.txt
│   ├── FINAL_OVERVIEW.txt
│   ├── GITHUB_ACTIONS_GUIDE.md
│   ├── CLOUD_COST_OPTIMIZATION.md
│   ├── GENERATOR_V2_ARCHITECTURE.md  (after merge)
│   ├── PANORAMA_TECNICO_COMPLETO.md
│   ├── PROJECT_STRUCTURE.txt
│   ├── PROJECT_STRUCTURE_UPDATED.txt
│   ├── DEPLOYMENT_SUMMARY.md
│   └── GITHUB_ACTIONS_SUMMARY.md
│
├── ARCHITECTURE.md                   # NEW (merge)
├── DEPLOY.md                         # NEW (merge)
├── GENERATOR_GUIDE.md                # UPDATE paths
├── GRU_SCRAPER_USAGE.md             # UPDATE if necessary
├── QUICKSTART.md                    # UPDATE commands
├── QUICK_REFERENCE.md               # UPDATE paths/commands
├── GOOGLE_INDEXING_SETUP.md         # UPDATE sitemap path
├── INDEXER_IMPLEMENTATION_SUMMARY.md # UPDATE paths
├── HISTORICAL_IMPORT_README.md       # UPDATE
├── HISTORICAL_IMPORT_SUMMARY.md      # UPDATE
├── HISTORICAL_IMPORTER_GUIDE.md      # UPDATE
├── IATA_DICTIONARY_GUIDE.md         # UPDATE if necessary
├── IATA_EXPANSION_SUMMARY.md         # UPDATE
├── IMPLEMENTATION_COMPLETE.md        # Keep (historical)
├── PERPLEXITY_INTEGRATION_SUMMARY.md # Keep
├── VISUAL_GUIDE.md                  # UPDATE paths/UI
└── PHASE1_TRIAGE_AND_CONSOLIDATION_PLAN.md  (this file)
```

---

## 6. Next step

Confirm if this plan is approved to:

1. Execute Phase 1 (create `archive/`, move obsolete, create ARCHITECTURE.md and DEPLOY.md, move merged originals to archive, update paths in others).  
2. Then execute Phase 2 (Perplexity/MCP for SEO and GitHub Actions) and, if desired, Phase 3 (root README and final polish).

If you want to change any item (e.g.: keep some file out of archive or not merge any listed), indicate and the plan can be adjusted before execution.
