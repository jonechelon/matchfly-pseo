{% extends "base.html" %}

{% block title %}Voos Atrasados GRU - Monitoramento e Direitos | MatchFly{% endblock %}
{% block meta_desc %}Monitoramento em tempo real dos voos mais atrasados em Guarulhos. Verifique seus direitos e receba compensação de até R$ 10.000. Atualizado a cada 15min.{% endblock %}
{% block canonical_url %}{{ base_url }}/atrasados.html{% endblock %}
{% block request_path %}/atrasados.html{% endblock %}

{% block breadcrumb_current %}Atrasados{% endblock %}

{% block alert_ticker %}
<div class="w-full bg-amber-900 text-white border-b border-amber-800 shadow-md sticky top-16 z-40">
    <div class="flex items-center h-10">
        <div class="bg-amber-950 px-4 h-full flex items-center gap-2 z-10 shrink-0 font-bold text-xs uppercase tracking-wider">
            <span class="relative flex h-2 w-2">
              <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-amber-400 opacity-75"></span>
              <span class="relative inline-flex rounded-full h-2 w-2 bg-amber-500"></span>
            </span>
            <span class="md:hidden">ATRASADOS</span>
            <span class="hidden md:inline">Últimos Atrasos</span>
        </div>
        
        <div class="ticker-wrap group cursor-default">
            <div class="animate-marquee hover:pause flex items-center gap-8 px-4">
                {% for i in range(2) %}
                    {% for flight in flights[:15] %}
                    <div class="flex items-center gap-2 text-sm font-medium opacity-90 hover:opacity-100 transition-opacity">
                        <i data-lucide="clock-4" class="w-4 h-4 text-amber-300"></i>
                        {% if flight.data_partida %}<span class="text-[10px] bg-white/10 px-1.5 rounded text-white/80 font-mono mr-1">{{ flight.data_partida }}</span>{% endif %}
                        <span class="text-amber-200">{{ flight.flight_number }}</span>
                        <span class="text-white">{{ flight.destination_city|default(flight.destination_iata)|default('N/A') }}</span>
                        <span class="text-xs bg-amber-950/50 px-2 py-0.5 rounded text-amber-200 border border-amber-800">{{ flight.scheduled_time|default('--:--') }}</span>
                    </div>
                    <span class="text-amber-700/50">•</span>
                    {% endfor %}
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_head %}
<!-- Schema Markup: ItemList -->
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "ItemList",
    "name": "Voos Atrasados em Guarulhos - Últimos 30 Dias",
    "description": "Lista dos voos mais atrasados em Guarulhos nos últimos 30 dias",
    "numberOfItems": {{ flights|length }},
    "itemListElement": [
        {% for flight in flights %}
        {
            "@type": "ListItem",
            "position": {{ loop.index }},
            "item": {
                "@type": "Flight",
                "flightNumber": "{{ flight.flight_number }}",
                "airline": {
                    "@type": "Airline",
                    "name": "{{ flight.airline }}"
                },
                "departureAirport": {
                    "@type": "Airport",
                    "iataCode": "GRU",
                    "name": "Aeroporto Internacional de Guarulhos"
                },
                "arrivalAirport": {
                    "@type": "Airport",
                    "iataCode": "{{ flight.destination_iata }}",
                    "name": "{{ flight.destination_city|default(flight.destination)|default('N/A') }}"
                }
            }
        }{% if not loop.last %},{% endif %}
        {% endfor %}
    ]
}
</script>

<!-- Schema Markup: BreadcrumbList -->
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
        {
            "@type": "ListItem",
            "position": 1,
            "name": "Início",
            "item": "{{ base_url }}/"
        },
        {
            "@type": "ListItem",
            "position": 2,
            "name": "Voos Atrasados",
            "item": "{{ base_url }}/atrasados.html"
        }
    ]
}
</script>
{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="bg-gradient-to-b from-orange-50 to-white py-16">
    <div class="container mx-auto px-4 max-w-6xl">
        <div class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-black text-orange-900 mb-4">
                Voos que Mais Atrasam em Guarulhos: Monitoramento em Tempo Real
            </h1>
            <h2 class="text-2xl md:text-3xl font-bold text-gray-700 mb-6">
                Evite Conexões Perdidas e Garanta Seus Direitos (EC 261 + ANAC 400)
            </h2>
            <p class="text-lg text-gray-600 max-w-3xl mx-auto">
                {{ flights|length }} voos atrasados identificados. Verifique se seu voo está na lista e garanta sua indenização de até <strong class="text-orange-900">R$ 10.000</strong>.
            </p>
        </div>
    </div>
</section>

<!-- Seção: Cards de Voos Atrasados (apenas Flip Cards) -->
<section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
    {% if flight_cards and flight_cards|length > 0 %}
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {% for card_html in flight_cards %}
            <div class="flex justify-center">{{ card_html | safe }}</div>
            {% endfor %}
        </div>
    {% else %}
        <div class="text-center py-12">
            <svg class="w-16 h-16 mx-auto mb-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            <p class="text-gray-500 text-lg font-medium">Nenhum voo atrasado no momento</p>
            <p class="text-gray-400 text-sm mt-2">Verifique outras categorias ou volte mais tarde</p>
        </div>
    {% endif %}
</section>

<!-- FAQ Section (Simplificada) -->
<section class="container mx-auto px-4 py-12 max-w-7xl">
    <div class="mt-12 p-6 bg-gray-50 rounded-xl border border-gray-200">
        <h2 class="text-2xl font-bold mb-6">Direitos do Passageiro para Voos Atrasados</h2>
        
        <div class="space-y-4">
            <div class="faq-item">
                <h3 class="font-bold text-lg text-blue-900">A partir de quanto tempo de atraso gera indenização?</h3>
                <p class="text-gray-700">Atrasos superiores a 4 horas permitem que o passageiro solicite indenização por danos morais. Além disso, a companhia deve fornecer assistência material (alimentação e comunicação) conforme o tempo de espera. 
                <a href="https://www.airhelp.com/en-int/?ref=matchfly" class="text-blue-600 underline font-bold">Calcule sua compensação agora.</a></p>
            </div>
        </div>
    </div>
</section>

<!-- FAQ Section (Simplificada) -->
<section class="container mx-auto px-4 py-12 max-w-7xl">
    <div class="mt-12 p-6 bg-gray-50 rounded-xl border border-gray-200">
        <h2 class="text-2xl font-bold mb-6">Direitos do Passageiro para Voos Atrasados</h2>
        
        <div class="space-y-4">
            <div class="faq-item">
                <h3 class="font-bold text-lg text-blue-900">A partir de quanto tempo de atraso gera indenização?</h3>
                <p class="text-gray-700">Atrasos superiores a 4 horas permitem que o passageiro solicite indenização por danos morais. Além disso, a companhia deve fornecer assistência material (alimentação e comunicação) conforme o tempo de espera. 
                <a href="https://www.airhelp.com/en-int/?ref=matchfly" class="text-blue-600 underline font-bold">Calcule sua compensação agora.</a></p>
            </div>
        </div>
    </div>
</section>

<!-- FAQ Section (Original - Mantida para compatibilidade) -->
<section id="faq" class="bg-slate-50 py-20 hidden">
    <div class="container mx-auto px-4 max-w-4xl">
        <div class="text-center mb-12">
            <div class="inline-flex items-center space-x-2 px-4 py-2 bg-orange-100 rounded-full mb-4">
                <span class="text-xs font-bold text-orange-900 uppercase tracking-wider">Perguntas Frequentes</span>
            </div>
            <h3 class="text-3xl md:text-5xl font-black text-blue-950 mb-4">
                Tire Suas Dúvidas
            </h3>
        </div>

        <div class="space-y-4">
            <!-- FAQ Item 1 -->
            <div class="bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden">
                <button onclick="toggleFAQ(1)" class="w-full px-6 py-5 flex items-center justify-between text-left hover:bg-orange-50 transition-colors group">
                    <h4 class="text-lg font-bold text-blue-950 pr-4">Tenho direito a indenização por voo cancelado?</h4>
                    <svg id="faq-icon-1" class="w-5 h-5 text-orange-900 flex-shrink-0 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                    </svg>
                </button>
                <div id="faq-content-1" class="hidden px-6 pb-5">
                    <p class="text-gray-600 leading-relaxed">
                        Sim! Segundo a Resolução ANAC 400, passageiros de voos nacionais cancelados sem aviso prévio de pelo menos 72 horas têm direito a indenização de até R$ 10.000. Para voos internacionais, a regulamentação EC 261 também garante compensação. 
                        <a href="https://funnel.airhelp.com/claims/new/trip-details?lang=pt-br&departureAirportIata=GRU&a_aid=69649260287c5&a_bid=c63de166&utm_medium=affiliate&utm_source=pap&utm_campaign=aff-69649260287c5" 
                           target="_blank" 
                           rel="noopener sponsored"
                           class="text-orange-600 hover:text-orange-800 font-semibold underline">
                            Verifique seu voo gratuitamente aqui
                        </a>.
                    </p>
                </div>
            </div>

            <!-- FAQ Item 2 -->
            <div class="bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden">
                <button onclick="toggleFAQ(2)" class="w-full px-6 py-5 flex items-center justify-between text-left hover:bg-orange-50 transition-colors group">
                    <h4 class="text-lg font-bold text-blue-950 pr-4">Qual o valor da compensação por atraso?</h4>
                    <svg id="faq-icon-2" class="w-5 h-5 text-orange-900 flex-shrink-0 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                    </svg>
                </button>
                <div id="faq-content-2" class="hidden px-6 pb-5">
                    <p class="text-gray-600 leading-relaxed">
                        O valor da compensação varia conforme o tipo de voo e o tempo de atraso. Voos nacionais com atraso superior a 4 horas podem gerar indenização de até R$ 10.000 (ANAC 400). Voos internacionais com atraso superior a 3 horas podem gerar compensação de até €600 (EC 261). 
                        <a href="https://funnel.airhelp.com/claims/new/trip-details?lang=pt-br&departureAirportIata=GRU&a_aid=69649260287c5&a_bid=c63de166&utm_medium=affiliate&utm_source=pap&utm_campaign=aff-69649260287c5" 
                           target="_blank" 
                           rel="noopener sponsored"
                           class="text-orange-600 hover:text-orange-800 font-semibold underline">
                            Calcule seu valor aqui
                        </a>.
                    </p>
                </div>
            </div>

            <!-- FAQ Item 3 -->
            <div class="bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden">
                <button onclick="toggleFAQ(3)" class="w-full px-6 py-5 flex items-center justify-between text-left hover:bg-orange-50 transition-colors group">
                    <h4 class="text-lg font-bold text-blue-950 pr-4">Como recebo a indenização?</h4>
                    <svg id="faq-icon-3" class="w-5 h-5 text-orange-900 flex-shrink-0 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                    </svg>
                </button>
                <div id="faq-content-3" class="hidden px-6 pb-5">
                    <p class="text-gray-600 leading-relaxed">
                        O processo é simples e gratuito. Você verifica seu voo, preenche um formulário online, e a AirHelp entra em contato com a companhia aérea em seu nome. Se aprovado, você recebe a indenização diretamente na sua conta. A AirHelp só recebe uma comissão se você for indenizado. 
                        <a href="https://funnel.airhelp.com/claims/new/trip-details?lang=pt-br&departureAirportIata=GRU&a_aid=69649260287c5&a_bid=c63de166&utm_medium=affiliate&utm_source=pap&utm_campaign=aff-69649260287c5" 
                           target="_blank" 
                           rel="noopener sponsored"
                           class="text-orange-600 hover:text-orange-800 font-semibold underline">
                            Inicie seu processo aqui
                        </a>.
                    </p>
                </div>
            </div>
        </div>

        <!-- CTA após FAQ -->
        <div class="mt-12 text-center">
            <a href="https://funnel.airhelp.com/claims/new/trip-details?lang=pt-br&departureAirportIata=GRU&a_aid=69649260287c5&a_bid=c63de166&utm_medium=affiliate&utm_source=pap&utm_campaign=aff-69649260287c5" 
               target="_blank" 
               rel="noopener sponsored"
               class="inline-flex items-center space-x-3 px-10 py-5 bg-gradient-to-r from-orange-600 to-orange-700 hover:from-orange-700 hover:to-orange-800 text-white font-bold text-lg rounded-full shadow-2xl hover:shadow-3xl transition-all hover:scale-105 group">
                <span>Verificar Meu Voo Atrasado Agora</span>
                <svg class="w-6 h-6 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
                </svg>
            </a>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_scripts %}
<script>
    function toggleFAQ(num) {
        const content = document.getElementById('faq-content-' + num);
        const icon = document.getElementById('faq-icon-' + num);
        
        if (content.classList.contains('hidden')) {
            // Fechar todos os outros
            for (let i = 1; i <= 3; i++) {
                if (i !== num) {
                    document.getElementById('faq-content-' + i).classList.add('hidden');
                    document.getElementById('faq-icon-' + i).classList.remove('rotate-180');
                }
            }
            // Abrir o selecionado
            content.classList.remove('hidden');
            icon.classList.add('rotate-180');
        } else {
            content.classList.add('hidden');
            icon.classList.remove('rotate-180');
        }
    }
</script>
{% endblock %}
